{
    "family": "test-logger-service",
    "requiresCompatibilities": [
        "EC2"
    ],
    "containerDefinitions": [
        {
            "name": "logger-service",
            "image": "beblue/logger-service",
            "cpu": 256,
            "memory": 1024,
            "portMappings": [
                {
                    "HostPort": 0,
                    "ContainerPort": 8000,
                    "Protocol": "tcp"
                }
            ],
            "environment": [
                {
                    "name": "ENVIRONMENT",
                    "value": "development"
                },
                {
                    "name": "POSTGRES_ENGINE",
                    "value": "django.db.backends.postgresql"
                },
                {
                    "name": "POSTGRES_HOST",
                    "value": "postgre-dev.database.beblue.com.br"
                },
                {
                    "name": "POSTGRES_NAME",
                    "value": "logger_service"
                },
                {
                  "name": "POSTGRES_USER",
                  "value": "logger_service"
                },
                {
                    "name": "POSTGRES_PASSWORD",
                    "value": "pHuteW=c*6sp"
                },
                {
                    "name": "POSTGRES_PORT",
                    "value": "5432"
                },
                {
                    "name": "DD_API_KEY",
                    "value": "12f2a1e88301811b4815d20bb562ab8a"
                },
                {
                  "name": "DJANGO_SECRET_KEY",
                  "value": "wm-g%qf8y#gc6h57a#6ywzobqy9t@5)%bcl*uf9!5nz@0v2pdc"
                },
                {
                  "name": "DJANGO_DEBUG",
                  "value": "True"
                },
                {
                  "name": "DATADOG_ENABLED",
                  "value": "True"
                },
                {
                  "name": "DATADOG_TAGS_ENV",
                  "value": "test"
                },
                {
                  "name": "DATADOG_DEFAULT_SERVICE",
                  "value": "logger-service"
                },
                {
                  "name": "DJANGO_MANAGEPY_MIGRATE",
                  "value": "False"
                },
                {
                  "name": "DJANGO_MANAGEPY_COLLECTSTATIC",
                  "value": "False"
                }
            ],
            "healthCheck": {
                "invertal": 30,
                "timeout": 5,
                "startPeriod": 120,
                "retries": 3,
                "command": [
                    "CMD-SHELL",
                    "test \"passing\" == $(curl -sf http://host-ip:8500/v1/agent/checks | jq -r '.[\"service:container:'$(cut -d\"/\" -f4 < /proc/1/cpuset)'\"].Status')"
                ]
            },
            "logConfiguration": {
                "logDriver": "fluentd",
                "options": {
                    "fluentd-address": "services.dev.beblue:26224",
                    "fluentd-sub-second-precision": true,
                    "tag": "log.inline.json"
                }
            }
        }
    ]
}